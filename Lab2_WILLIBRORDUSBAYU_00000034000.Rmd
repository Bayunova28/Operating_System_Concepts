---
title: "Week 2 Visualizing a Single Variable dengan R (Rev)"
author: "Tim Dosen Sistem Informasi"
date: "2019-08"
output:
  html_document: default
  pdf_document: default
editor_options: 
  chunk_output_type: console
---  

******************************************************************************************************
Nama    : Willibrordus Bayu.....................   
NIM     : 00000034000.....................   
Date    : Rabu, 2 September 2020.....................   
Asistent: .....................    
Waktu   : Max 4x50 menit   
********************************************************************************

Petunjuk untuk mahasiswa:   
------------------------
  1. Nyalakan dan periksa PC kalau ada problem laporkan ke Asisten dan pindah ke PC yang lain   
  2. Dapatkan dari asistent dan rename file markdown ini dengan WEEK2_Vis1_NAMA_NIM   
  3. Isi dulu data-data kamu di atas!    
  4. Mahasiswa mengerjakan WAJIB mengerjakan A1, B1, dan C1 dan jawaban boleh dishow
     oleh Assistent
  5. Asisten memilih satu atau dua soal lagi per masing-masing section 
     sebagai KEWAJIBAN mahasiswa menegerjakan di lab.
  6. Sisa soal boleh dikerjakan di luar lab sebagai PR dikumpulkan minggu depan.
  7. Kerjakan soal-soal yang bisa dulu dengan benar   
  8. Isilah jawabanmu di area {R} yang berwarna abu-abu   
  9. Kalau mengalami kesulitan, silakan cari solusi diinternet/buku catatan dll    
  10. Maximal mengerjakan sesi ini dan sesi lainnya adalah 200 menit (3 jam 20 menit)   
  11. Bila sudah selesai dan yakin benar, silakan simpan ditempat yang ditentukan oleh asisten   

Tatacara Penilaian Praktek di Lab:
-----------------------------------
  1. Cara penilaian praktikum:    
     a. Setiap praktek di lab tidak dinilai kecuali quiz di minggu ke 7, 13, dan 14.   
     b. Setiap mahasiswa wajib mengerjakan 2 soal per sesi (A, B, C dst). 
        Di week 2 ini minimal 6 soal yang harus selesai di lab.
        b.1. Bila selesai saat di lab maka mahasiswa akan ikut dipresensi.   
        b.2. mahasiswa hadir namun tidak dikumpulkan/tidak selesai maka tidak dipresensi.   
        b.3. mahasiswa absen, otomatis tidak dipresensi.
     c. Sisa soal boleh dikerjakan sebagai PR minggu depan, bila tidak dikumpulkan, tidak dipresensi
        di minggu depan. Tata cara pengumpulan PR ditentukan oleh Assistent.    
  2. a. Mahasiswa wajib datang di saat quiz diadakan di lab. 
     b. Mahasiswa yang absen disaat quiz, nilai quiz tsb=0.01, dan tidak ada quiz pengganti/susulan.
  3, Tugas dapat dilihat di RPKPS LAB dikumpulkan minggu ke 14. 
  4. UTS berupa ujian di lab (atau online) dapat dilihat di RPKPS.
  4. UAS berupa ujian di lab (atau online) dapat dilihat di RPKPS.

===================
A Diagram Pie   
===================

Soal A1 (Jawaban boleh dishow di layar tapi tidak diberikan)
------------------------------------------------------------------------------------------------------
Kelas X terdiri dari 25 Pria dan 15 Wanita.
Gambarkan diagram Pienya!
Catatan:

   a. Pria warna hitam, Wanita warna Merah
   b. Judul=".................... oleh <Nama> <Nim>" (harus diketik penuh tidak boleh dibuat fungsi) 
   c. Harus lengkap dengan kontribusinya   
   
Jawab:
```{R}
   #-----------------preparation------------------------------
    library(readxl)
    Labdata2 <- read_excel("D:/Data Analysis - Lab/Labdata2.xlsx")
    View(Labdata2)

   #-----------------show time--------------------------------
    respondent <- c(25,15)
    label <- c("pria","wanita")
    judul <- "Diagram Pie Kelas X Oleh Willibrordus Bayu 00000034000"
    kontribusi <- round(100*respondent/sum(respondent),1)
    label_lengkap <- paste(label,kontribusi,"%",sep = " ")
    pie(respondent,label_lengkap,main = judul,col = warna)
   
```
   
Soal A2 (Jawaban tidak boleh dishow) 
---------------------------------------------------------------------------------
Kelas Y terdiri dari 20 Pria dan 20 Wanita.
Gambarkan diagram Pie X dan Y secara berdampingan!
Catatan:

   a. Pria warna hitam, Wanita warna Merah
   b. Salah satu Judul=".................... oleh <Nama> <Nim>" (harus diketik penuh tidak boleh dibuat fungsi)
   c. Harus lengkap dengan kontribusinya
Jawab:
```{R}
   #--------------Kelas X----------------------
    kelasx <- c(25,15)
    label <- c("Pria","Wanita")
    judul = "Diagram Gender pada Kelas X oleh Willibrordus Bayu 00000034000"
    warna = c("Black","Red")
    kontribusi <- round(100*kelasx/sum(kelasx),1)
    label_lengkap <- paste(label,kontribusi,"%",sep = " ")
    pie(kelasx,label_lengkap,main = judul,col = warna)
    
   #--------------kelas Y----------------------
    kelasY <- c(20,20)
    label <- c("Pria","Wanita")
    judul = "Diagram Gender pada Kelas Y Oleh Willibrordus Bayu 00000034000"
    warna = c("Black","Red")
    kontribusi <- round(100*kelasY/sum(kelasY),1)
    label_lengkap <- paste(label,kontribusi,"%",sep = " ")
    pie(kelasY,label_lengkap,main = judul,col = warna)


   #-------------show time---------------------
    par(mfrow=c(1,2))
    pieX <- pie(kelasx,label_lengkap,main = judul,col = warna)
    pieY <- pie(kelasY,label_lengkap,main = judul,col = warna)
    mtext(text = "Diagram Gender Kelas X dan Y Oleh Willibrordus Bayu 00000034000")


```

SOAL A3 (Jawaban tidak boleh dishow)
------------------------------------------------------------------------------------------------------
Ukuran sepatu mahasiswa di kelas X: "S", "S", "S", "S", "S", "S", "S", "S", "S", "S", "M", "M", "M", "M", "L", "L".
Buatlah diagram pienya dimana warna merah untuk S, kuning untuk M, dan Hijau untuk L
Catatan:
   a. Warna Large Hijau, Medium Kuning, Small Merah
   b. Judul=".................... oleh <Nama> <Nim>" (harus diketik penuh tidak boleh dibuat fungsi)
   c. Harus lengkap dengan kontribusinya   
   
JAWAB:
```{R}
    respondent <- c(10,4,2)
    label <- c("S","M","L")
    Judul = "Diagram Ukuran Sepatu di Kelas X Oleh Willibrordus Bayu 00000034000"
    warna = c("Red","Yellow","Green")
    kontribusi <- round(100*respondent/sum(respondent),1)
    label_lengkap <- paste(label,kontribusi,"%",sep = " ")
    pie(respondent,label_lengkap,main = Judul,col = warna)



```

Soal A4 (Jawaban tidak boleh dishow)
--------------------------------------------------------------------------------------------
Gunakan dataset mtcars pada R dan buatlah diagram pie berdasarkan variabel hp (horsepower)
dengan syarat setiap merk harus memiliki hp di atas 200.   
Catatan:
   a. Warna bebas
   b. Judul=".................... oleh <Nama> <Nim>" (harus diketik penuh tidak boleh dibuat fungsi)
   c. Harus lengkap dengan kontribusinya
Jawab:
```{R}
   #--------------Kelas X----------------------
    par(mfrow=c(1,1))
    dataa <- subset(mtcars, hp>200)
    hp <- table(dataa$hp)
    warna <- c(1:length(hp))
    nama <- names(hp)
    keterangan<-paste(nama,kontribusi,"%",sep=" ")
    kontribusi<- round(100*hp/sum(hp), 1)
    pie(hp,main = Judul,keterangan,col = warna)


   #-------------show time---------------------




```

=============
B Diagram Bar   
=============

Soal B1 (Jawaban boleh dishow di layar tapi tidak diberikan)
------------------------------------------------------------------------------------------------------
Kelas X terdiri dari 25 Pria dan 15 Wanita mahasiswa.   
Gambarkan diagram Batangnya!
   a. Judul=".................... oleh <Nama> <Nim>" (harus diketik penuh tidak boleh dibuat fungsi)  
   b. warna pria=hitam, wanita=merah      
Jawab:
```{R}
   #-----------------preparation------------------------------
    library(readxl)
    Labdata2 <- read_excel("D:/Data Analysis - Lab/Labdata2.xlsx")
    View(Labdata2)

   #-----------------show time--------------------------------
    respondent <- c(25,15)
    sumbux <- "jenis kelamin"
    sumbuy <- "jumlah mahasiswa"
    judul <- "Diagram Batang Kelas X Oleh Willibrordus Bayu 00000034000"
    label <- c("pria","wanita")
    warna = c("black","red")
    barplot(respondent,xlab = sumbux,ylab = sumbuy,main = judul,names=label,col = warna)


```

Soal B2 (Jawaban tidak boleh dishow)
------------------------------------------------------------------------------------------------------
Kelas A terdiri dari 25 Pria dan 15 Wanita sedangkan kelas B terdiri dari 20 Pria dan 20 Wanita
Gambarkan diagram Batang bertumpuknya (Stacked Bar)!
Catatan:   
   a. Judul=".................... oleh <Nama> <Nim>" (harus diketik penuh tidak boleh dibuat fungsi) 
   b. warna pria=biru muda, wanita=merah muda
   c. gunakan legend namun tidak boleh bertumpuk dengan batangnya
Jawab:
```{R Soal1, echo=TRUE, warning=TRUE}
   #-----------------preparation------------------------------
    library(readxl)
    Labdata2 <- read_excel("D:/Data Analysis - Lab/Labdata2.xlsx")
    View(Labdata2)

   #-----------------show time--------------------------------
    respondent <- c(25, 15)
    wanita <- c(20, 20)
    pria <- respondent-wanita
    gender <- rbind(wanita,pria)
    sumbux="Kelas" 
    sumbuy="Jumlah Mahasiswa"
    judul = "Diagram Batang Kelas A & B Oleh Willibrordus bayu 00000034000" 
    label <- c("Kelas A", "Kelas B") 
    warna = c("Light Blue","Pink") 
    barplot(gender,xlab=sumbux,ylab=sumbuy,main=judul,names=label,col=warna,
    legend =c("Wanita","Pria"))

```

Soal B3 (Jawaban tidak boleh dishow)
-------------------------------------------------------------------------------------------
Pada dataset Orange di R terdapat 5 pohon dengan data umur (age) dan circumference
Gambarkan diagram batang berdampingan untuk kelima pohon tsb!
Catatan:
   a. Judul=".................... oleh <Nama> <Nim>" (harus diketik penuh tidak boleh dibuat fungsi) 
   b. sumbu mendatar age, sumbu vertikal circumference.
   b. warna bebas asal harus berbeda untuk setiap pohonnya
   c. gunakan legend namun tidak boleh bertumpuk dengan batangnya        
   Jawab:
```{R}
    library(dplyr)
    
    PohonA <- subset(Orange, Tree == 1)
    PohonB <- subset(Orange, Tree == 2)
    PohonC <- subset(Orange, Tree == 3)
    PohonD <- subset(Orange, Tree == 4)
    PohonE <- subset(Orange, Tree == 5)
    circumbind <- rbind(PohonA$circumference,PohonB$circumference,PohonC$circumference,PohonD$circumference,PohonE$circumference)
    barplot(circumbind,main = "Bar Chart Pertumbuhan Pohon Oleh Willibrordus Bayu 00000034000", xlab = "Umur",ylab = "Lingkar Tahun",names.arg = c("Sangat Mudah", "Muda","Awal Dewasa", "Setengah Dewasa", "Dewasa","Setengah Tua","Tua"), col = c("Red", "Orange", "Yellow", "Green", "Blue"))
legend("topleft", legend = c("PohonA","PohonB","PohonC", "PohonD", "PohonE"), fill = c("Red", "Orange", "Yellow", "Green", "Blue"))
   

   #-----------------show time--------------------------------


```

Soal B4 (Jawaban tidak boleh dishow)
-------
Buatlah diagram batang berdampingan cut untuk setiap clarity untuk data diamonds pada package tidyverse.    
a. Diamond yang dipilih adalah diamond yang memiliki harga di atas 1000 dolar.   
b. Judul = "Diamonds Cut by Clarity oleh NIM xxx"     
c. Sumbu mendatar: clarity   
d. Legend: cut   
e. Gunakan warna berbeda untuk setiap cut.  
f. Adjust ylim sehingga sumbu Y untuk diagram batang tidak terpotong.   

```{r}
    library(tidyselect)
    library(ggplot2)
    
    Diamond <- subset(diamonds, price>1000)
    judul <- "Diamonds Cut by Clarity Oleh Willibrordus Bayu 00000034000"
    coba <- table(diamond$cut, diamond$clarity)
    warna = c("Red", "Orange", "Yellow", "Green", "Blue")
    barplot(coba, col = warna, xlab = "Clarity", main = judul, beside = TRUE, ylim = c(0,4000))
    
    legend("topright",legend=c("Fair","Good","Very Good", "Premium", "Ideal"), fill=c("Red", "Orange", "Yellow", "Green", "Blue"), cex = 0.7)


```

================
C Diagram Garis
================

Soal C1 (Jawaban boleh dishow di layar tapi tidak diberikan)
------------------------------------------------------------------------------------------------------
Laporan Penjualan Mobil di Bulan Januari ada 800 buah, bulan Februari ada 170 buah, bulan Maret 500 buah dan bulan April 100 buah. 
catatan:

a. garis penuh
b. warna garis merah
c. pada setiap bulan diberi titik berbentuk bulat
d. Judul="....................... oleh <Nama> <Nim>" (harus diketik penuh tidak boleh dibuat fungsi) 
Jawab:
```{R}
	# -----------------------Persiapan-------------------------------------------------------
	# membuat data berbentuk vektor
    mobil <- c(800,170,500,100)

  # membuat judul chart
    judul = "Diagram Perkembangan Penjualan Mobil X Oleh Willibrordus Bayu 00000034000"

	# titik dan garis
    tipe = "o"
     
	# membuat warna
    warna = c("Red")

	# --------------Mmembuat Line Chart Sederhana----------------------------------------- 
    plot(mobil,xlab = sumbux,ylab = sumbuy,main = judul,type = tipe,col=warna)
    
    par(yaxt="n")
    plot(x, y, type="b")
    lablist.x<-as.vector(c(1:10))
    lablist.x<-as.vector(c("Januari", "Februari", "Maret", "April", "", ""))
    axis(1, at=seq(1, 10, by=1), labels = FALSE)
    text(x = seq(1, 10, by=1), par("usr")[3] - 0.2, labels = lablist.x, srt = 45, pos = 1, xpd = TRUE)
    axis(2, at=seq(0, 100, by=20), labels = FALSE)
    text(y = seq(0, 100, by=20), par("usr")[1], labels = lablist.y, srt = 45, pos = 2, xpd = TRUE)


```

Soal C2 (Jawaban tidak boleh dishow)
------------------------------------------------------------------------------------------------------
Suatu cafe menjual 4 jenis hidangan yaitu Kopi, Teh, dan Jus.
Kopi Bulan Januari ada 800 gelas, bulan Februari ada 200 gelas, bulan Maret 500 gelas dan bulan April 300 gelas. 
Teh: Bulan Januari ada 600 gelas, bulan Februari ada 250 gelas, bulan Maret 700 gelas dan bulan April 200 gelas. 
Jus: Bulan Januari ada 700 gelas, bulan Februari ada 900 gelas, bulan Maret 400 gelas dan bulan April 100 gelas.
Buatlah diagram gars untuk ketiga jenis minuman tsb.   
Catatan:

a. Kopi garis hitam solid 
b. Teh garis merah longdash
c. Jus garis hijau dotted
d. pada setiap bulan diberi titik bebas asalkan setiap jenis minuman berbeda
e. Judul="....................... oleh <Nama> <Nim>" (harus diketik penuh tidak boleh dibuat fungsi) 

Jawab:
------------------------------------------------------------------------------------------------------
```{R}
kopi <- c(800, 200, 500, 300)
teh  <- c(600, 250, 700, 200)
jus  <- c(700, 900, 400, 100)
sumbux = "Bulan"
sumbuy = "Gelas"
judul = "Diagram Laporan Penjualan pada Cafe oleh Willibrordus Bayu 00000034000"
tipe = "o" 
labels <- c("Januari","Februari","Maret","April")

plot(kopi, xlab=sumbux,ylab=sumbuy,main=judul,type=tipe,col="Black",ylim = c(0,900))
lines(teh, type="o", col="Red")
lines(jus, type="o", col="Green")

par(yaxt="n")
plot(x, y, type="b")
lablist.x<-as.vector(c(1:10))
lablist.x<-as.vector(c("Januari", "Februari", "Maret", "April", "", ""))
axis(1, at=seq(1, 10, by=1), labels = FALSE)
text(x = seq(1, 10, by=1), par("usr")[3] - 0.2, labels = lablist.x, srt = 45, pos = 1, xpd = TRUE)
axis(2, at=seq(0, 100, by=20), labels = FALSE)
text(y = seq(0, 100, by=20), par("usr")[1], labels = lablist.y, srt = 45, pos = 2, xpd = TRUE)
	
```

Soal C3 (Jawaban tidak boleh dishow)
-----------------------------------------------
Berikut ini adalah data harga penutupan (adjusted closing price) Indeks Saham Gabungan (^JKSE), saham Bank BRI (BBRI.JK) dan saham Astra (ASII.JK) bulanan selama tahun 2019. 
Gambarkan grafik garis untuk membandingkan keempat data ini.   

Date	JKSEAdjClose	BBRIAdjustClose	ASIIAdjClose   
2019-01	6533.0	3718	8275   
2019-02	6443.3	3718	7002   
2019-03	6468.8	3969	7148   
2019-04	6455.4	4220	7467   
2019-05	6209.1	3959	7295   
2019-06	6358.6	4360	7450  
2019-07	6390.5	4480	7000  
2019-08	6250.6	4300	6750   

Catatan:
a. IHSG garis hitam solid
b. BRI garis merah dotdash
c. Astra garis biru dotted
d. Tuliskan legend untuk ketiga item di atas. Gunakan kode BBRI.JK dst sebagai label legend.
e. Label pada sumbu x: "Bulan", label pada sumbu Y: "Harga Penutupan"
f. Judul="Harga Saham BRI dan Astra vs IHSG oleh <Nama> <Nim>" (harus diketik penuh tidak boleh dibuat fungsi) 

```{r}
    IHSG <- c(6533.0, 6443.3, 6468.8, 6455.4, 6209.1, 6358.6, 6390.5, 6250.6)
    BBRIJK <- c(3718, 3718, 3969, 4220, 3959, 4360, 4480, 4300)
    Astra <- c(8275, 7002, 7148, 7467, 7295, 7450, 7000, 6750)
    Bulan <- c(1,2,3,4,5,6,7,8)
    plot(IHSG, type = "o",col = "black", xlab = "Bulan", ylab = "Harga Penutupan", main = "Harga Saham BRI dan Astra vs IHSG Oleh Willibrordus Bayu 00000034000", ylim = c(0,10000))

    points(BBRIJK~Bulan, col="red", pch="#")
    lines(BBRIJK, type = "o", col = "red", lty = 2)
    points(Astra~Bulan, col="blue", pch="+")
    lines(Astra, type = "o", col= "blue", lty = 3)
    legend("bottomleft",legend=c("IHSG","BBRI.JK","ASII.JK"), col=c("black","red","blue"), pch=c("o","#","+"), x = lty=c(1,2,3), ncol = 1, cex = 0.70)

```

Soal C4 (Jawaban tidak boleh dishow)
-----------------------------------------------

Berikut ini adalah data Covid-10 dari <https://www.kaggle.com/hendratno/covid19-indonesia>.

Gambarkan:

a. Baca data dari file **IS388LabWeek2.xls** sheet **"covidindonesia"**. Carilah 3 propinsi dengan kasus covid baru terbanyak per juta penduduk. Buatlah data frame baru untuk masing-masing propinsi tersebut.
b. Gambarkan Grafik New Cases per Million untuk ketiga propinsi di atas dengan warna dan tipe garis yang berbeda.
c. Beri judul "Top 3 Propinsi Kasus Baru Per Juta Penduduk" dan subjudul "oleh ... (isi dengan nama lengkap dan NIM anda)."
e. Beri label sumbu X dengan "Tanggal" dan label sumbu Y "Kasus Baru per Juta Pendududuk".
f. Berikan legend pada posisi kiri atas untuk masing-masing propinsi tersebut.

```{r}
    library(readxl)
    Labdata2 <- read_excel("Labdata2.xlsx", sheet = "covidindonesia")
    Dat1 <- subset(Covid, Covid$'Location Level' == "Province")
    Dat2 <- Dat2[order(-Dat2$'New Cases per Million'),]
    
    gorontalo <- subset(Covid, Covid$Province == "Gorontalo")
    malut <- subset(Covid, Covid$Province == "Maluku Utara")
    kalut <- subset(Covid, Covid$Province == "Kalimantan Utara")
    
    plot(gorontalo$Date, gorontalo$'New Cases per Million', type = "l", col = "LightGreen", lty = 1, xlab = "Tanggal", ylab = "Kasus Baru per Juta Penduduk", main = "Top 3 Propinsi Kasus Baru Per Juta Penduduk", sub = "Willibrordus bayu 00000034000")
    lines(malut$Date, malut$'New Cases per Million', type = "l", col = "Red", lty = 4)
    lines(kalut$Date, kalut$'New Cases per Million', type = "l", col = "Black", lty = 5)
    
    legend("topleft", lty = c(1, 4, 5), col = c("Green", "Red", "Black"), legend = c("Gorontalo", "Maluku Utara", "Kalimantan Utara"))


#Propinsi dengan new cases per million terbanyak
#1. Gorontalo
#2. Maluku Utara
#3. Kalimantan Utara


```

